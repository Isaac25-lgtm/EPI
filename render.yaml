# Render.com Configuration
# Optimized for 10,000+ concurrent users

services:
  - type: web
    name: uganda-ehmis-analytics
    env: python
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn -c gunicorn.conf.py wsgi:app
    healthCheckPath: /health
    envVars:
      - key: FLASK_ENV
        value: production
      - key: SECRET_KEY
        generateValue: true
      - key: DHIS2_BASE_URL
        value: https://hmis.health.go.ug/api
      - key: DHIS2_TIMEOUT
        value: 60
      - key: GUNICORN_WORKERS
        value: 4
      - key: GUNICORN_THREADS
        value: 4
      - key: GUNICORN_TIMEOUT
        value: 120
      - key: PYTHON_VERSION
        value: 3.12.0
    autoDeploy: true
    
  # Optional: Redis for session storage (enables 10,000+ users)
  # - type: redis
  #   name: ehmis-redis
  #   plan: starter
  #   ipAllowList: []
